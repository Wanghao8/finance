<view class="container flexc0c">
    <van-nav-bar title="收支明细">
        <image class="filter" src="../../assets/images/screening.png" bindtap="filter" slot="left"></image>
    </van-nav-bar>
    <view class="top-select flexr0c">
        <view class="top-select-item-box flexrcc" bind:tap="selectIO" data-type="1">
            <view class="top-select-item {{IO==1?'select-active':''}}">收支明细</view>
        </view>
        <view class="top-select-item-box flexrcc" bind:tap="selectIO" data-type="2">
            <view class="top-select-item {{IO==2?'select-active':''}}">分析</view>
        </view>
    </view>
    <!-- 收支明细部分 -->
    <view hidden="{{IO!=1}}" class="">
        <view class="middle-box flexr0c">
            <view class="income-box flexrcc">
                <view class="middle-label">收入</view>
                <view class="income-num">+50000.00</view>
            </view>
            <view class="split-line"></view>
            <view class="outcome-box flexrcc">
                <view class="middle-label">支出</view>
                <view class="outcome-num">-20000.00</view>
            </view>
        </view>
        <scroll-view class="" scroll-x="false" scroll-y="true" upper-threshold="50" lower-threshold="50" style="height:{{(screenHeight-hair-200)*2}}rpx">
            <view class="list-box">
                <view class="list-item flexrbc" wx:for="{{list}}" wx:key="index">
                    <view class="check-type" hidden="{{item.checkState==1}}">未审核</view>
                    <view class="list-item-left flexr">
                        <image class="paytype" src="../../assets/images/WeChat.png" hidden="{{item.tradeType!=4}}"></image>
                        <image class="paytype" src="../../assets/images/Alipay.png" hidden="{{item.tradeType!=3}}"></image>
                        <image class="paytype" src="../../assets/images/zhuanzhanghuikuan.png" hidden="{{item.tradeType!=1}}"></image>
                        <view class="list-item-content-box">
                            <view class="list-item-title">渑池豪瑞矿产品购销站</view>
                            <view class="list-item-time">2020-08-22 14:23:34</view>
                            <view class="list-item-address">支付宝|三门峡</view>
                        </view>
                    </view>
                    <view class="list-item-right">
                        <view class="flexr0c">
                            <view class="{{inout==1?'list-item-num':'list-item-num'}}">
                                +1258000
                            </view>
                            <image src="../../assets/images/The arrow.png" />
                        </view>
                        <view class="in-type">入账中</view>
                    </view>
                </view>
            </view>
        </scroll-view>
    </view>
    <!-- 分析部分 -->
    <scroll-view class="list-container" scroll-x="false" scroll-y="true" upper-threshold="50" lower-threshold="50" style="height:{{(screenHeight-150-hair)*2}}rpx" hidden="{{IO!=2}}" class="flexc0c analysis-box">
        <view class="chartbar1-box">
            <view class="chartbar1-top flexrcc">
                <view class="previous" bind:tap="previous">前一年</view>
                <view class="thisyear">{{thisyear}}年</view>
                <view class="next" bind:tap="next">后一年</view>
            </view>
            <view class="chartbar1-title flexr0c">
                <view class="label-line"></view>
                <view class="label-title">月度收支</view>
                <view class="label-sub">单位（万元）</view>
            </view>
            <view class="chartbar1-box-item">
                <ec-canvas id="mychart-dom-bar" canvas-id="mychart-bar" ec="{{ ecbar1 }}" bind:tap="changeMonth" force-use-old-canvas="true"></ec-canvas>
            </view>
        </view>
        <view class="chartbar2-box flexc0c">
            <view class="chartbar2-top flexc0c">
                <view class="chartbar2-title">2020年08月1日---2020年08月31日</view>
                <view class="inout-box flexr0c">
                    <view class="income flexr0c">
                        <view class="income-label">收入</view>
                        <view class="income-num">+50000.00</view>
                    </view>
                    <view class="split-line2"></view>
                    <view class="outcome flexr0c">
                        <view class="outcome-label">支出</view>
                        <view class="outcome-num">-20000.00</view>
                    </view>
                </view>
            </view>
            <view class="chartbar2-title flexrb">
                <view class="inout-label-box flexr0c">
                    <view class="label-line"></view>
                    <view class="label-title">各市县出入金排名</view>
                </view>
                <view class="inout-btn flexr0c">
                    <view bindtap="income" class="income-btn {{inoutBtn=='in'?'inout-active':''}}">
                        入金
                    </view>
                    <view bindtap="outcome" class="outcome-btn {{inoutBtn=='out'?'inout-active':''}}">
                        出金
                    </view>
                </view>
            </view>
            <view class="chartbar2-container">
                <view class="" wx:for="{{rankList}}" wx:key="index">
                    <view class="city-name">市县名称</view>
                    <view class="flexrbc">
                        <!-- <view class="income-line-item" style="width:{{item*502/rankList[0]}}rpx"></view> -->
                        <view class="income-line-item"></view>
                        <view class="income-item-num"></view>
                    </view>
                    <view class="flexrbc">
                        <view class="outcome-line-item"></view>
                        <view class="outcome-item-num"></view>
                    </view>
                </view>
            </view>
            <view class="chartbar2-table">
                <view class="table-title flexr0c">
                    <view class="title-address">市县</view>
                    <view class="title-income">月度入金</view>
                    <view class="title-outcome">月度出金</view>
                </view>
                <view class="table-item flexr0c" wx:for="{{table}}" wx:key="index">
                    <view class="{{index%2==0?'table-backfff':'table-backyellow'}}">
                        {{item.add}}
                    </view>
                    <view class="{{index%2==0?'table-backfff':'table-backyellow'}} table-income">
                        {{item.in}}
                    </view>
                    <view class="{{index%2==0?'table-backfff':'table-backyellow'}}">
                        {{item.out}}
                    </view>
                </view>
            </view>
        </view>
        <view class="chartline-box">
            <view class="chartline-top flexr0c">
                <view class="label-line"></view>
                <view class="label-title">每日缴款</view>
                <view class="label-sub">单位（万元）</view>
            </view>
            <view class="chartline-container">
                <ec-canvas id="mychart-dom-line" canvas-id="mychart-line" ec="{{ecline}}" force-use-old-canvas="true"></ec-canvas>
            </view>
        </view>
        <view class="chartpie-box">
            <view class="chartpie-top flexr0c">
                <view class="label-line"></view>
                <view class="label-title">交易类型占比</view>
            </view>
            <view class="chartpie-container">
                <ec-canvas id="mychart-dom-line" canvas-id="mychart-line" ec="{{ ecpie }}" force-use-old-canvas="true"></ec-canvas>
            </view>
        </view>
        <view class="rankcompany">
            <view class="chart-top-left flexr0c">
                <view class="label-line"></view>
                <view class="chart-top-left-title">企业缴纳排名（前十）</view>
            </view>
            <view class="rank-tabel">
                <view class="rank-tabel-item" wx:for="{{needfold?needcarshort:needcarlong}}" wx:key="index">
                    <view class="rank-title">
                        {{item.ENTERPRISE_NAME?item.ENTERPRISE_NAME:'(空)'}}
                    </view>
                    <view class="flexr0c">
                        <view class="progress-bar {{brand=='an'?'pro-an':''}} {{brand=='iphone'?'pro-iphone':''}} {{brand=='iphonex'?'pro-iphonex':''}}">
                            <view class="progress {{brand=='an'?'pro-an':''}} {{brand=='iphone'?'pro-iphone':''}} {{brand=='iphonex'?'pro-iphonex':''}}" style="width:{{item.COUNT/needcarshort[0].COUNT*560}}rpx;color:#F5A623;"></view>
                        </view>
                        <view class="progress-num">{{item.COUNT}}</view>
                    </view>
                </view>
            </view>
            <view class="unfold flexrcc" bindtap="fold" data-type="needunfold" hidden="{{!needfold}}">
                <view class="unfold-title">展开</view>
                <image src="../../assets/images/10openarrow.png"></image>
            </view>
            <view class="fold flexrcc" bindtap="fold" data-type="needfold" hidden="{{needfold}}">
                <view class="fold-title">收起</view>
                <image src="../../assets/images/11closearrow.png"></image>
            </view>
        </view>
    </scroll-view>
    <!-- tabbar -->
    <van-tabbar active="{{ active }}" bind:change="changeTab">
        <van-tabbar-item>
            <image slot="icon" src="{{ icon.index }}" mode="aspectFit" style="width: 20px; height: 20px;" />
            <image slot="icon-active" src="{{ icon.indexactive }}" mode="aspectFit" style="width: 20px; height: 20px;" />
            首页
        </van-tabbar-item>
        <van-tabbar-item>
            <image slot="icon" src="{{ icon.inout }}" mode="aspectFit" style="width: 20px; height: 20px;" />
            <image slot="icon-active" src="{{ icon.inoutactive }}" mode="aspectFit" style="width: 20px; height: 20px;" />
            收支明细
        </van-tabbar-item>
        <van-tabbar-item>
            <image slot="icon" src="{{ icon.set }}" mode="aspectFit" style="width: 20px; height: 20px;" />
            <image slot="icon-active" src="{{ icon.setactive }}" mode="aspectFit" style="width: 20px; height: 20px;" />
            设置
        </van-tabbar-item>
    </van-tabbar>
</view>
<!-- 抽屉弹出 -->
<van-popup show="{{ show }}" position="right" custom-style="width: 76%;" bind:close="closeDraw">
    <view class="drawer">
        <view class="drawer-top-box">
            <view class="drawer-top">
                <view class="drawer-top-label">企业名称</view>
                <input type="text" bindinput="changeComName" placeholder="请输入您要查找的企业名称" placeholder-class="input-placeholder" />
                <view class="drawer-top-label">交易单号</view>
                <input type="text" bindinput="changeDealId" placeholder="请输入您要查找的交易单号" placeholder-class="input-placeholder" />
                <view class="drawer-top-label">地区</view>
                <input type="text" bindinput="changeLocation" placeholder="请输入您要查找的地区" placeholder-class="input-placeholder" />
            </view>
        </view>
        <view class="money-box">
            <view class="money-label">选择金额</view>
            <view class="btn-box flexrbc" bindtap="radio">
                <view data-index="0" class="{{radio==0?'btn-active':'btn'}}">小于1万</view>
                <view data-index="1" class="{{radio==1?'btn-active':'btn'}}">1万-3万</view>
                <view data-index="2" class="{{radio==2?'btn-active':'btn'}}">3万-5万</view>
                <view data-index="3" class="{{radio==3?'btn-active':'btn'}}">5万-10万</view>
                <view data-index="4" class="{{radio==4?'btn-active':'btn'}}">大于10万</view>
                <view data-index="5" class="{{radio==5?'btn-active':'btn'}}">不限制</view>
            </view>
            <view class="input-box flexrbc">
                <input type="text" bindinput="changeMin" name="" id=""></input>
                <view class="to-line"></view>
                <input type="text" bindinput="changeMax"></input>
            </view>
        </view>
        <view class="paytype-box">
            <view class="paytype-label">交易类型</view>
            <view class="flexr0c">
                <van-checkbox checked-color="#F2AD3C" value="{{ cardChecked }}" shape="square" bind:change="changeCheckbox" data-type="card">
                    POS刷卡
                </van-checkbox>
                <van-checkbox checked-color="#F2AD3C" value="{{ aliChecked }}" shape="square" bind:change="changeCheckbox" data-type="alipay">
                    POS支付宝
                </van-checkbox>
            </view>
            <view class="flexr0c">
                <van-checkbox checked-color="#F2AD3C" value="{{ WechatChecked }}" shape="square" bind:change="changeCheckbox" data-type="wechat">
                    POS微信
                </van-checkbox>
                <van-checkbox checked-color="#F2AD3C" value="{{ bankChecked }}" shape="square" bind:change="changeCheckbox" data-type="bank">
                    网银转账
                </van-checkbox>
            </view>
            <van-checkbox checked-color="#F2AD3C" value="{{ outChecked }}" shape="square" bind:change="changeCheckbox" data-type="out">
                支出
            </van-checkbox>
        </view>
        <view class="bottom-btn-box flexr0c">
            <view class="bottom-btn-cancel" bind:tap="cancelBtn">取消</view>
            <view class="bottom-btn-comfirm" bind:tap="comfirmBtn">确定</view>
        </view>
    </view>
</van-popup>